_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[31],{Bjpw:function(e,t,n){"use strict";n.r(t);var r,O,_=n("o0o1"),a=n.n(_),c=n("HaE+"),o=n("rePB"),E=n("8go8"),T=n("sdoi"),u=n("Pvxg"),P=n("q1tI"),i=n.n(P),s=n("/MKj"),S=n("rwk0"),l=n("aPyc"),f=n("T3pB"),b=n("2ZAf"),A=n("d86I"),R=i.a.createElement;function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}!function(e){e.PUA_POST_EDITOR_ON_SHOW="PUA_POST_EDITOR_ON_SHOW",e.PUA_POST_EDITOR_ON_CLOSE="PUA_POST_EDITOR_ON_CLOSE",e.PUA_POST_EDITOR_ON_LOADED="PUA_POST_EDITOR_ON_LOADED",e.PUA_POST_EDITOR_ON_CREATE_SUCCESS="PUA_POST_EDITOR_ON_CREATE_SUCCESS",e.PUA_POST_EDITOR_ON_CREATE_FAIL="PUA_POST_EDITOR_ON_CREATE_FAIL",e.PUA_POST_EDITOR_ON_AUTH_FAIL="PUA_POST_EDITOR_ON_AUTH_FAIL"}(r||(r={})),function(e){e.PUA_POST_EDITOR_PRELOAD="PUA_POST_EDITOR_PRELOAD",e.PUA_POST_EDITOR_SHOW="PUA_POST_EDITOR_SHOW",e.PUA_POST_EDITOR_RESET_CONTENT="PUA_POST_EDITOR_RESET_CONTENT",e.PUA_POST_EDITOR_SET_OG="PUA_POST_EDITOR_SET_OG",e.PUA_POST_EDITOR_SILENT_CREATE_POST="PUA_POST_EDITOR_SILENT_CREATE_POST"}(O||(O={}));var I=!1,D=[b.a.HK01_SITE],p=function(e){I&&window.parent.postMessage(e,"*")},d=function(){var e=Object(P.useRef)(),t=Object(l.g)().emitFire,n=Object(S.t)().createPost,_=Object(b.m)(),a=_.closeEditor,c=_.generateOgPreview,d=_.cancelOgpreviewRequest,j=_.deleteOg,v=_.createPostByContentRequest,w=Object(s.d)(f.i),C=Object(P.useState)({}),N=C[0].source,g=C[1],m=E.a(N,D)?N:b.a.HK01_SITE,L=Object(P.useCallback)((function(e){p({event:r.PUA_POST_EDITOR_ON_CREATE_SUCCESS,params:{story:e}})}),[]),k=Object(P.useCallback)((function(e){var t=e.message;p({event:r.PUA_POST_EDITOR_ON_CREATE_FAIL,params:{message:t}})}),[]),y=Object(P.useCallback)((function(){p({event:r.PUA_POST_EDITOR_ON_CLOSE})}),[]),H=Object(P.useCallback)((function(){p({event:r.PUA_POST_EDITOR_ON_AUTH_FAIL})}),[]),h=Object(P.useCallback)((function(e){e&&(d(),j(),c(e))}),[d,j,c]),F=Object(P.useCallback)((function(){e.current&&(Object(S.r)(e.current,""),d(),j())}),[d,j]),B=Object(P.useCallback)((function(t){F();var n=t.ogUrl,r=t.content;h(n),e.current&&Object(S.r)(e.current,r)}),[F,h]),W=Object(P.useCallback)((function(O){n({source:m,isLinkStory:!0,callback:L,failCallback:k,onCloseCallback:y,onDidMount:function(n){if(e.current=n,O.defaultValue&&B(O.defaultValue),O.preload)return a(),void p({event:r.PUA_POST_EDITOR_ON_LOADED});t(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},l.f.postEditorView(m))),p({event:r.PUA_POST_EDITOR_ON_SHOW})}})}),[n,m,t,y,k,L,a,B]),V=Object(P.useCallback)((function(e){if(e.data&&"object"===typeof e.data&&e.data.event&&"string"===typeof e.data.event){var t=e.data;switch(t.event){case O.PUA_POST_EDITOR_RESET_CONTENT:F();break;case O.PUA_POST_EDITOR_PRELOAD:W({preload:!0});break;case O.PUA_POST_EDITOR_SHOW:var n={ogUrl:"",content:""},r=T.a(u.a(n,["params","defaultValue"],t),n),_=r.ogUrl,a=r.content;W({defaultValue:{ogUrl:_,content:a}});break;case O.PUA_POST_EDITOR_SET_OG:var c=u.a("",["params","ogUrl"],t);if(!c)return;h(c);break;case O.PUA_POST_EDITOR_SILENT_CREATE_POST:var o={ogUrl:"",content:""},E=T.a(u.a(o,["params","value"],t),o),P=E.ogUrl,i=E.content;if(!i){var s=new Error("Empty content");return s.erroCode="empty_string_error",k(s)}v({content:i,ogUrl:P},L,k);break;default:console.log("[OT_DEBUG] Invalid event name",e)}}}),[v,F,k,L,h,W]);return Object(P.useEffect)((function(){I=window.parent!==window}),[]),Object(P.useEffect)((function(){w===f.b.UNAUTHORIZED&&H()}),[H,w]),Object(P.useEffect)((function(){return window.addEventListener("message",V),function(){window.removeEventListener("message",V)}}),[V]),Object(P.useEffect)((function(){var e=Object(A.a)(["source"]);g({source:e.source})}),[]),R(i.a.Fragment,null,R(S.d,null))};d.getInitialProps=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)}))),t.default=d},d86I:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n("cRdr"),O=function(e){var t=new URLSearchParams(window.location.search),n=Object.fromEntries(t.entries());return r.a(e,n)}},vioL:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/iframe/postEditor",function(){return n("Bjpw")}])}},[["vioL",1,2,4,7,0,3,5,6]]]);
//# sourceMappingURL=postEditor-a1098959dd49bfbcd84e.js.map